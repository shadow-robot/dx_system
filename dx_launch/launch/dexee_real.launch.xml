<?xml version="1.0" encoding="utf-8"?>
<!--
 Copyright (C) 2024 Shadow Robot Company Ltd - All Rights Reserved. Proprietary and Confidential.
 Unauthorized copying of the content in this file, via any medium is strictly prohibited.
-->
<launch>
  <arg name="debug" default="false"/>
  <arg name="hand_type" default="0x02000105"/>
  <arg name="ethercat_port" default="$(optenv ETHERCAT_PORT enp1s0)"/>
  <arg name="robot_config" default=""$(find dx_config)/robot/$(arg side)/$(arg hand_type).yaml" />
  <arg name="log_user" default="user"/>
  <arg name="controller_output" default="log"/>
  <arg name="controller_start_delay" default="5"/>
  <arg name="state_controller_start_delay" default="2"/>

  <arg name="start_control" default="false"/>
  <arg name="control_mode" default="none"/>
  <!-- allowed values are trajectory, actuator_pwm, actuator_effort, joint_effort, position -->
  <arg name="side" default="right"/>
  <arg name="robot_state_pub_frequency" default="250"/>
  <arg name="joint_state_pub_frequency" default="125"/>
  
  <include file="$(find dx_launch)/launch/dexee_driver_only.launch">
    <arg name="debug" value="$(arg debug)"/>
    <arg name="hand_type" value="$(arg hand_type)"/>
    <arg name="ethercat_port" value="$(arg ethercat_port)"/>
    <arg name="robot_config" value="$(arg robot_config)"/> 
    <arg name="bootload_mode" value="false"/>
    <arg name="serial_mode" value="false"/>
    <arg name="log_user" value="$(arg log_user)"/>
    <arg name="controller_output" value="$(arg controller_output)"/>
    <arg name="state_controller_start_delay" value="$(arg state_controller_start_delay)"/>
    <arg name="side" value="$(arg side)"/>
    <arg name="robot_state_pub_frequency" value="$(arg robot_state_pub_frequency)"/>
    <arg name="joint_state_pub_frequency" value="$(arg joint_state_pub_frequency)"/>
  </include>

  <!--controllers-->

  <node if="$(arg start_control)" name="controller_timed_launch" pkg="sr_utilities_common" type="timed_roslaunch.sh"
        args="$(arg controller_start_delay) dx_launch $(arg control_mode)_controller.launch hand_type:=$(arg hand_type) side:=$(arg side) output:=$(arg controller_output)" />
  
  <node pkg="dx_robot" type="check_subdevices" name="enable_robot" output="screen" />
</launch>
